<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Agendamento - Sistema Multi-Planilhas</title>
    <link rel="stylesheet" href="styles.css">
</head>

<body>
    <div class="header">
        <div class="header-left">
            <h1>üìä Sistema de Atualiza√ß√£o de Agendamentos</h1>
            <p>Verifica e carrega dados existentes da planilha</p>

    <!-- Busca por Site Name/Chave -->
    <div class="search-section">
        <h3>üîç Buscar por Site Name / Chave</h3>

        <!-- Sele√ß√£o de Projeto -->
        <div class="form-row">
            <div class="form-group" style="flex: 1;">
                <label for="projetoBusca">Projeto *</label>
                <select id="projetoBusca" required onchange="toggleBuscaCampos()">
                    <option value="">Selecione</option>
                    <option value="Atacadao">Atacad√£o</option>
                    <option value="Bradesco">Bradesco</option>
                </select>
            </div>
        </div>

        <!-- Campo para ATACAD√ÉO -->
        <div class="form-row" id="campoAtacadao" style="display: none;">
            <div class="form-group" style="flex: 2;">
                <label for="buscarSiteName">Site Name para Buscar *</label>
                <input type="text" id="buscarSiteName" placeholder="Digite o Site Name exato para buscar e atualizar">
            </div>
        </div>

        <!-- Campo para BRADESCO -->
        <div class="form-row" id="campoBradesco" style="display: none;">
            <div class="form-group" style="flex: 2;">
                <label for="buscarChave">Chave Bradesco *</label>
                <input type="text" id="buscarChave" placeholder="Digite a Chave do Bradesco">
            </div>
        </div>

        <button class="btn-search" onclick="buscarDados()" id="btnBuscar">
            <span id="btnBuscarText">üîç Buscar e Carregar Dados</span>
            <div id="btnBuscarLoader" class="loader" style="display: none;"></div>
        </button>
    </div>

    <!-- Formul√°rio de Atualiza√ß√£o -->
    <div class="form-container">
        <form id="agendamentoForm">
            <div class="form-section">
                <h3>üìã Informa√ß√µes do Agendamento</h3>
                <div class="form-row">
                    <div class="form-group">
                        <label id="chaveLabel">Site Name (Chave):</label>
                        <div id="siteNameDisplay" style="padding: 10px; background: #f1f1f1; border-radius: 5px; color: #2d2d2d;">
                            <span>Busque um Site Name/Chave primeiro</span>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="projeto">Projeto *</label>
                        <select id="projeto" name="projeto" required disabled onchange="toggleCamposFormulario()">
                            <option value="">Selecione o projeto</option>
                            <option value="Atacadao">Atacad√£o</option>
                            <option value="Bradesco">Bradesco</option>
                        </select>
                    </div>
                </div>
            </div>

            <!-- Campo Chave (s√≥ aparece para Bradesco) -->
            <div class="form-row" id="campoChaveForm" style="display: none;">
                <div class="form-group">
                    <label for="chave">Chave Bradesco *</label>
                    <input type="text" id="chave" name="chave" placeholder="Chave do Bradesco">
                </div>
            </div>

            <!-- Campos comuns para ambos os projetos -->
            <div class="form-section">
                <h3>üë§ Dados do Agendamento</h3>
                <div class="form-row">
                    <div class="form-group">
                        <label for="tecnico">Nome do T√©cnico *</label>
                        <input type="text" id="tecnico" name="tecnico" placeholder="Nome completo do t√©cnico">
                    </div>
                    <div class="form-group">
                        <label for="cpf">CPF do T√©cnico *</label>
                        <input type="text" id="cpf" name="cpf" placeholder="000.000.000-00">
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="data">Data do Agendamento *</label>
                        <input type="date" id="data" name="data">
                    </div>
                    <div class="form-group">
                        <label for="horario">Hor√°rio *</label>
                        <input type="time" id="horario" name="horario">
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="status">Status</label>
                        <select id="status" name="status">
                            <option value="Agendado">Agendado</option>
                            <option value="Em Andamento">Em Andamento</option>
                            <option value="Conclu√≠do">Conclu√≠do</option>
                            <option value="Cancelado">Cancelado</option>
                        </select>
                    </div>
                </div>
            </div>

            <div class="form-actions">
                <button type="button" class="btn-secondary" onclick="limparFormulario()">Limpar</button>
                <button type="submit" class="btn-primary" id="submitBtn" disabled>
                    <span id="btnText">Atualizar Linha na Planilha</span>
                    <div id="btnLoader" class="loader"></div>
                </button>
            </div>

            <div class="message" id="message"></div>
        </form>
    </div>

        </div>
    </div>
    </div>

    <script src="script.js"></script>
</body>

</html>